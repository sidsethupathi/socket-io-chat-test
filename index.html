<html>
<head>
</head>

<body>
danny got owned
<form action="">
<input type="text" id="n" autocomplete="off" placeholder="name">
<input type="text" id="m" autocomplete="off">
<button>Send</button>
<span id="num_users">Number of users: -</span>
</form>
<div id="is_typing"></div>


<ul id="messages">
</ul>

<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>
  var socket = io();
  $('form').submit(function() {
  	socket.emit('chat message', {name: $('#n').val(), msg: $('#m').val()});
  	$('#m').val('');
  	return false;
  });

  $('#m').keyup(function() {
  	if($('#m').val() != '') {
  		socket.emit('typing', $('#n').val());
  	} else {
  		console.log("emitting that i'm done typing");
  		socket.emit('done typing');
  	}
  });

  socket.on('chat message', function(data) {
  	console.log('incoming message: ' + data.msg);
  	$("#messages").append($('<li>').text(data.name + ' - ' + data.msg));
  });

  socket.on('num users', function(msg) {
  	$("#num_users").text("Number of users: " + msg);
  });

  socket.on('typing', function(name) {
  	$("#is_typing").text(name + " is typing...");
  });

  socket.on('done typing', function() {
  	console.log("clearing the is typing box");
  	$("#is_typing").html("");
  });

</script>

</body>
</html>